
<style>
    body {
        background-color: white
    }

    .height-100 {
        height: 100vh
    }

    .card {
        width: 400px;
        border: none;
        top:-100px;
        height: 300px;
        box-shadow: 0px 5px 20px 0px #d2dae3;
        z-index: 1;
        display: flex;
        justify-content: center;
        align-items: center
    }

        .card h6 {
            color: red;
            font-size: 20px
        }

    .inputs input {
        width: 40px;
        height: 40px
    }

    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
        margin: 0
    }

    .card-2 {
        background-color: #fff;
        padding: 10px;
        width: 350px;
        height: 100px;
        bottom: 50px;
        left: 20px;
        position: absolute;
        border-radius: 5px
    }

        .card-2 .content {
            margin-top: 50px
        }

            .card-2 .content a {
                color: red
            }

    .form-control:focus {
        box-shadow: none;
        border: 2px solid red
    }

    .validate {
        border-radius: 20px;
        height: 40px;
        background-color: red;
        border: 1px solid red;
        width: 140px
    }
</style>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha384-nvAa0+6Qg9clwYCGGPpDQLVpLNn0fRaROjHqs13t4Ggj3Ez50XnGQqc/r8MhnRDZ" crossorigin="anonymous"></script>
<script src="~/Content/jsapi.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ajaxy/1.6.1/scripts/jquery.ajaxy.min.js" integrity="sha512-bztGAvCE/3+a1Oh0gUro7BHukf6v7zpzrAb3ReWAVrt+bVNNphcl2tDTKCBr5zk7iEDmQ2Bv401fX3jeVXGIcA==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-ajaxy/1.6.1/scripts/jquery.ajaxy.js" integrity="sha512-4WpSQe8XU6Djt8IPJMGD9Xx9KuYsVCEeitZfMhPi8xdYlVA5hzRitm0Nt1g2AZFS136s29Nq4E4NVvouVAVrBw==" crossorigin="anonymous"></script>

<div class="row">
    <div class="col-md-4" id="">
        @*<button class="btn btn-danger px-4 validate" onclick="">Send OTP</button>*@
    </div>
    <div class="col-md-4" id="OTP">
        <div class="container height-100 d-flex justify-content-center align-items-center">
            <div class="position-relative">
                <div class="card p-2 text-center">
                    <h6>Please enter the one time password <br> to verify your account</h6>
                    <div> <span>A code has been sent to</span> <small>*******@ViewBag.result</small> </div>
                    <div id="otp" class="inputs d-flex flex-row justify-content-center mt-2"> <input class="m-2 text-center form-control rounded" type="text" id="first" maxlength="1" /> <input class="m-2 text-center form-control rounded" type="text" id="second" maxlength="1" /> <input class="m-2 text-center form-control rounded" type="text" id="third" maxlength="1" /> <input class="m-2 text-center form-control rounded" type="text" id="fourth" maxlength="1" /> <input class="m-2 text-center form-control rounded" type="text" id="fifth" maxlength="1" /> <input class="m-2 text-center form-control rounded" type="text" id="sixth" maxlength="1" /> </div>
                    <div class="mt-4"> <button class="btn btn-danger px-4 validate" onclick="verifyOTP()">Validate</button> </div>
                </div>
                <div class="card-2">
                    <div class="content d-flex justify-content-center align-items-center"> <span>Didn't get the code</span> <a href="#" class="text-decoration-none ms-3" onclick="SendOTP()">Resend OTP</a> </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js'></script>
<script src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js'></script>  
<div id="loading">
    <img id="loading-image" src="~/Content/spinner/Spinner-3.gif" alt="Loading..." />
</div>
<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function (event) {

        function OTPInput() {
            const inputs = document.querySelectorAll('#otp > *[id]');
            for (let i = 0; i < inputs.length; i++) { inputs[i].addEventListener('keydown', function (event) { if (event.key === "Backspace") { inputs[i].value = ''; if (i !== 0) inputs[i - 1].focus(); } else { if (i === inputs.length - 1 && inputs[i].value !== '') { return true; } else if (event.keyCode > 47 && event.keyCode < 58) { inputs[i].value = event.key; if (i !== inputs.length - 1) inputs[i + 1].focus(); event.preventDefault(); } else if (event.keyCode > 64 && event.keyCode < 91) { inputs[i].value = String.fromCharCode(event.keyCode); if (i !== inputs.length - 1) inputs[i + 1].focus(); event.preventDefault(); } } }); }
        } OTPInput();
    });
</script>
<style>
    #loading {
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        position: fixed;
        display: block;
        opacity: 0.7;
        background-color: #fff;
        z-index: 99;
        text-align: center;
    }

    #loading-image {
        position: absolute;
        top: 350px;
        left: 750px;
        z-index: 100;
        width: 50px;
        height: 50px;
    }
</style>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
    $(document).ready(function () {
        @*var message = '@TempData["message"]';
        swal({
            title: "Success!",
            text: message
        });*@
        SendOTP();
        $('#loading').hide();
        
    });
</script>
<script>
   function SendOTP() {
        $('#loading').show();
        $.ajax({
            url: '@Url.Action("SendOTP", "EmployeeManager")',

            type: 'GET',
            dataType: 'json',
            success: function (result) {
                swal({
                    title: "Success!",
                    text: result
                });

                $('#loading').hide();
            },
            TempDataDataerror: function (error) {
                $('#loading').hide();
                alert(error.responseText);

        }
        });
    }

    function verifyOTP() {
        $('#loading').show();
        var otp = [];
        var i = 0;

            $("input[type='text']").each(function () {
                otp.push($(this).val())
                console.log(i + " : " + otp[i]);
                i += 1;
            });
        var values = otp.toString();
        values.replace(/,/g, " ");

        console.log(values);
        console.log(otp);
        $.ajax({
            url: '@Url.Action("VerifyOTP", "EmployeeManager")',
            newUrl: '',
            type: 'GET',
            dataType: 'json',
            timeout: 30000,
            data: { values: values },
            success: function (result) {
                $('#loading').hide();
                if (result == "Success") {
                    swal({
                        title: "Success!",
                        text: "Your mobile number is verified success..."
                    });
                    window.location = '@Url.Action("Index","EmployeeDashboard") ';
                } else {
                    swal({
                        title: "Failure!",
                        text: "Incorrect otp please try again....."
                    });
                }
            },
            error: function (error) {
                $('#loading').hide();
                alert(error.responseText);
            }

        });
    }
</script>